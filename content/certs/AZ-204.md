# AZ-204: Developing Solutions for Microsoft Azure - Study Guide

Tài liệu tổng hợp các services quan trọng cho kỳ thi AZ-204. Nội dung tập trung vào phát triển ứng dụng, serverless, database và security.

---

## 1. Azure Compute Solutions (Giải pháp Tính toán)

### Azure App Service
Dịch vụ PaaS đầy đủ tính năng để host web apps, REST APIs, và mobile backends.
- **Key Concepts:**
    - **App Service Plan**: Định nghĩa tài nguyên (CPU, RAM) và giá tiền (Free, Basic, Standard, Premium).
    - **Scaling**: 
        - **Scale Up**: Tăng RAM/CPU (đổi gói Plan).
        - **Scale Out**: Tăng số lượng instance (máy con).
    - **Deployment Slots**: Giúp deploy code mới vào môi trường Staging, warm-up, rồi swap sang Prod in 1 click.

### Azure Functions (Serverless)
Chạy code (Function) theo sự kiện (Event-driven) mà không cần quan tâm hạ tầng.
- **Hosting Plans**:
    - **Consumption Plan**: Trả tiền theo số lần chạy. Auto-scale cực nhanh. (Cold start có thể xảy ra).
    - **Premium Plan**: Luôn có instance ấm (avoid cold start), hỗ trợ VNet integration.
    - **App Service Plan**: Chạy trên hạ tầng App Service có sẵn (dự đoán được chi phí).
- **Triggers & Bindings**:
    - **Trigger**: Cái gì kích hoạt function chạy (VD: HTTP Request, Timer, Blob mới).
    - **Binding**: Kết nối input/output tới service khác (VD: Ghi output vào Cosmos DB) mà không cần viết code kết nối phức tạp.

### Azure Container Registry (ACR)
Kho chứa Docker Image riêng tư (Private Docker Registry).
- **Benefit**: Lưu trữ image bảo mật, build image tự động với **ACR Tasks**.

### Azure Container Instances (ACI)
Cách nhanh nhất để chạy container trên Azure.
- **Use Case**: Task xử lý ngắn hạn, batch job đơn giản, hoặc test container. Không cần quản lý cluster.

---

## 2. Azure Storage Solutions (Giải pháp Lưu trữ)

### Azure Cosmos DB
Database NoSQL đa mô hình, phân tán toàn cầu (Global Distribution).
- **APIs**: SQL (Core), MongoDB, Cassandra, Gremlin (Graph), Table.
- **Consistency Levels**: Strong (mạnh nhất, chậm) > Bounded Staleness > Session (mặc định) > Consistent Prefix > Eventual (nhanh nhất, dữ liệu update sau cùng).
- **Request Units (RU/s)**: Đơn vị tính tiền và hiệu năng của Cosmos DB.

### Azure Blob Storage
- **Tiering**: Hot, Cool, Archive (như AZ-104).
- **Lifecycle Management**: Rule để tự động di chuyển data giữa các tier.
- **Metada**: Lưu trữ thông tin phụ cho file.
- **Access Control**:
    - **User Delegation SAS**: Tạo link truy cập tạm thời cho file, được ký bởi Entra ID (Bảo mật hơn SAS key thường).
    - **Azure CDN**: Phân phối nội dung tĩnh (ảnh, video) từ Blob ra các edge server toàn cầu để giảm độ trễ cho user.


---

## 3. Azure Security (Bảo mật)

### Azure Key Vault
Lưu trữ bí mật an toàn (Secrets, Keys, Certificates).
- **Secrets**: Chuỗi kết nối DB, API Keys.
- **Keys**: Khóa mã hóa (Encryption keys).
- **Certificates**: Chứng chỉ SSL/TLS.
- **Benefit**: Tách biệt thông tin nhạy cảm khỏi source code. Code chỉ gọi URI của Key Vault để lấy giá trị.

### Microsoft Entra ID (For Developers)
- **App Registrations**: Đăng ký ứng dụng của bạn với Azure AD để có thể thực hiện đăng nhập (SSO).
- **MSAL (Microsoft Authentication Library)**: Thư viện code giúp dev tích hợp chức năng login, lấy token dễ dàng.
- **Service Principal**: "Cái bóng" của ứng dụng trong Azure AD. Là danh tính dùng để code đăng nhập thay vì user thật. (Managed Identity thực chất là Service Principal được Azure tự quản lý).
- **Permissions**:

- **Permissions**:
    - **Delegated**: App thay mặt user đang đăng nhập để làm gì đó (VD: đọc email của user).
    - **Application**: App tự chạy nền (service daemon) không cần user, có quyền cao hơn.


### Managed Identities
Cấp danh tính cho Azure Resource để tự động xác thực với service khác (như SQL, Storage, Key Vault).
- **System-assigned**: Gắn liền với vòng đời resource (xóa VM -> xóa identity).
- **User-assigned**: Tạo độc lập, có thể gán cho nhiều resource.
- **Benefit**: **Không cần lưu username/password trong code**.

---

## 4. Monitoring & Troubleshooting (Giám sát & Gỡ lỗi)

### Azure Monitor & Application Insights
- **Application Insights**: Dành riêng cho Developers. Cài SDK vào code để theo dõi:
    - **Live Metrics**: Xem request/fail realtime.
    - **Failures**: Phân tích exception, lỗi 500.
    - **Performance**: Thời gian phản hồi chậm ở đâu (database hay code).
    - **User Map**: User đến từ đâu, hành vi ra sao.

### Kusto Query Language (KQL) Basics
- **Syntax**: `TableName | where Column == "Value" | take 10`
- **Search**: Tìm từ khóa trên toàn bộ bảng (`search "Error"`).
- **Where**: Lọc theo điều kiện (`where SeverityLevel == 3`).
- **Take/Limit**: Lấy n dòng mẫu.


---

## 5. Connect & Consume Azure Services (Kết nối & Tích hợp)

### Azure Service Bus
Message Broker (Hàng đợi) cho doanh nghiệp (Enterprise grade).
- **Queue**: 1-1 (Một người gửi, một người nhận). Dữ liệu được lưu cho đến khi xử lý xong.
- **Topic**: 1-N (Một người gửi, nhiều Subscriber nhận). Dùng cho mô hình Publish-Subscribe.

### Azure Event Grid
Dịch vụ định tuyến sự kiện (Event Routing).
- **Concept**: Bắn sự kiện "Fire and Forget". Phản ứng khi có thay đổi trạng thái (VD: Blob vừa được tạo -> Trigger Function).
- **Difference**: Event Grid dành cho **Sự kiện** (nhẹ), Service Bus dành cho **Tin nhắn** (nặng, quan trọng, transactional).

### Azure Event Hubs
Nền tảng streaming dữ liệu lớn (Big Data Streaming).
- **Use Case**: Nhận hàng triệu sự kiện mỗi giây (Telemetry, IoT logs).

### Azure Logic Apps
Workflow orchestration (tương tự như IFTTT hay Zapier nhưng cho doanh nghiệp).
- **Low-code/No-code**: Kéo thả connector để tích hợp các hệ thống (VD: Khi có email mới -> Lưu đính kèm vào OneDrive -> Bắn tin nhắn Teams).
- **Connectors**: Hàng trăm có sẵn (Salesforce, Office 365, SQL, etc.).

### Azure SignalR Service
Dịch vụ thời gian thực (Real-time).
- **Use Case**: Chat app, Dashboard cập nhật số liệu chứng khoán liên tục mà không cần F5.

### Azure App Configuration
Quản lý cấu hình tập trung và Feature Flags.
- **Benefit**: Thay vì sửa file `appsettings.json` rồi deploy lại, chỉ cần sửa trên Azure -> App tự cập nhật setting mới.


### Azure API Management (APIM)
Cổng gateway đứng trước các Backend APIs.
- **Benefits**:
    - **Security**: Xác thực, rate limiting (giới hạn lượt gọi/giây).
    - **Transformation**: Chuyển đổi response XML sang JSON.
    - **Developer Portal**: Trang web document cho dev khác dùng API.

### Azure Cache for Redis
Dịch vụ Cache trong bộ nhớ (In-memory caching).
- **Benefit**: Tăng tốc độ truy cập dữ liệu, giảm tải cho Database chính.
- **Eviction Policies (Chính sách xóa Cache)**:
    - **volatile-lru**: Xóa key có hạn sử dụng (TTL) ít dùng nhất.
    - **allkeys-lru**: Xóa key bất kỳ ít dùng nhất (dùng khi đầy bộ nhớ).
    - **noeviction**: Không xóa gì cả, báo lỗi khi đầy.

